<html lang='en'>
<head>
    <meta content='text/html; charset=utf-8' http-equiv='Content-Type'>
    <base href="">

    <link href='metricsgraphics.css' rel='stylesheet' type='text/css'>
    <script src='https://cdnjs.cloudflare.com/ajax/libs/jquery/3.1.0/jquery.min.js'></script>
    <script src='https://d3js.org/d3.v5.min.js' charset='utf-8'></script>
    <script src='metricsgraphics.min.js'></script>
</head>

<body>
        <div class='row trunk-section'>
                <div class='col-lg-7 text-center' id='id_temperature'></div>
                <div class='col-lg-7 text-center' id='id_humidity'></div>
                <div class='col-lg-7 text-center' id='id_pressure'></div>
                <div class='col-lg-7 text-center' id='id_luximity'></div>
                <div class='col-lg-5'>

<script>
console.log(location.href);
let url = new URL(location.href);
let sparams = new URLSearchParams(url.search);
console.log(sparams.get('file'));
let data_file = sparams.get('file');

//d3.json('data/fake_users1.json').then(function(data) {
//d3.dsv(",", 'data/2018_8/2018_8_8.csv').then(function(data) {
d3.dsv(",", data_file).then(function(data) {
    data = MG.convert.date(data, 'date', '%Y/%m/%dT%H:%M:%SZ');
    //console.log(data);

    var data_temp = MG.clone(data);
    var data_pressure = MG.clone(data);
    var data_luximity = MG.clone(data);
    var data_humidity = MG.clone(data);
    for (var i = 0; i < data.length; i++) {
        data_temp[i].value = data[i].temperature;
        data_pressure[i].value = data[i].pressure;
        data_luximity[i].value = data[i].luximity;
        data_humidity[i].value = data[i].humidity;
    }
    //console.log(data1);
    //console.log(data2);

    MG.data_graphic({
        title: "Temperature (C)",
        data: data_temp,
        width: 600,
        height: 200,
        right: 40,
        target: '#id_temperature',
        x_accessor: 'date',
        y_accessor: 'value'
    });

    MG.data_graphic({
        title: "Humidity (%)",
        data: data_humidity,
        width: 600,
        height: 200,
        right: 40,
        target: '#id_humidity',
        x_accessor: 'date',
        y_accessor: 'value'
    });

    MG.data_graphic({
        title: "Pressure (mm Hg)",
        data: data_pressure,
        width: 600,
        height: 200,
        right: 40,
        target: '#id_pressure',
        x_accessor: 'date',
        y_accessor: 'value'
    });

    MG.data_graphic({
        title: "Luximity (lux)",
        data: data_luximity,
        width: 600,
        height: 200,
        right: 40,
        target: '#id_luximity',
        x_accessor: 'date',
        y_accessor: 'value'
    });
});
</script>

</body>
</html>
